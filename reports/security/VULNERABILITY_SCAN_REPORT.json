{
  "timestamp": 1760968390326,
  "scanTypes": [
    "SAST",
    "Dependency",
    "DAST"
  ],
  "totalVulnerabilities": 19,
  "summary": {
    "critical": 3,
    "high": 1,
    "medium": 5,
    "low": 10,
    "info": 0
  },
  "scans": {
    "sast": {
      "timestamp": 1760968390327,
      "scannedFiles": 63,
      "vulnerabilities": [
        {
          "id": "dcd7fe60-74ad-40c0-aea2-92f94454b1eb",
          "file": "client\\secure\\crypto-loader.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 504,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390350
        },
        {
          "id": "3ad3ffb4-4fd8-41cb-b951-2865f0f13c41",
          "file": "code-quality-analyzer.js",
          "type": "code-injection",
          "severity": "high",
          "message": "使用eval()可能导致代码注入攻击",
          "line": 234,
          "recommendation": "避免使用eval()，考虑使用JSON.parse()或其他安全替代方案",
          "timestamp": 1760968390351
        },
        {
          "id": "69d78aac-bc52-4777-a51a-9d0dab25b6f9",
          "file": "examples\\ecc-demo.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 87,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390352
        },
        {
          "id": "b3d46521-081e-4398-96be-a73f5e575643",
          "file": "examples\\simple-worker-demo.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 29,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390353
        },
        {
          "id": "08653362-4719-4eb4-93f1-874eec345419",
          "file": "examples\\worker-demo.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 44,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390355
        },
        {
          "id": "f2abb4aa-09cf-44a6-8ec4-f7818ae8c832",
          "file": "monitoring-system.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 293,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390356
        },
        {
          "id": "345ad63a-3749-4547-9048-350845601dbf",
          "file": "run-advanced-monitoring.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 134,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390356
        },
        {
          "id": "d61b82e5-dbce-4861-b9be-a0ef27c7f90e",
          "file": "run-feature-demo.js",
          "type": "hardcoded-secrets",
          "severity": "critical",
          "message": "检测到硬编码的敏感信息",
          "line": 25,
          "recommendation": "将敏感信息移至环境变量或安全配置文件",
          "timestamp": 1760968390359
        },
        {
          "id": "562652dc-0f05-47a3-8718-0cb39fc05b14",
          "file": "run-feature-demo.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 58,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390359
        },
        {
          "id": "181d23a3-8f94-4228-98db-9abfe5b33f0d",
          "file": "run-monitoring.js",
          "type": "weak-randomness",
          "severity": "low",
          "message": "Math.random()不适用于安全相关的随机数生成",
          "line": 36,
          "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
          "timestamp": 1760968390359
        },
        {
          "id": "1f31fb92-5ce3-428a-abc6-d7e487ae79cb",
          "file": "client\\secure\\index.html",
          "type": "inline-script",
          "severity": "medium",
          "message": "内联脚本可能违反CSP策略",
          "line": 292,
          "recommendation": "将脚本移至外部文件或使用CSP nonce",
          "timestamp": 1760968390380
        },
        {
          "id": "5a440e38-a0fb-4d82-88f7-d5a7b59240ba",
          "file": "client\\secure\\index.html",
          "type": "inline-style",
          "severity": "low",
          "message": "内联样式可能违反CSP策略",
          "line": 1,
          "recommendation": "将样式移至外部CSS文件",
          "timestamp": 1760968390380
        },
        {
          "id": "18bf701d-1230-4d4d-83aa-b40259ccfb49",
          "file": "examples\\vue-app\\index.html",
          "type": "inline-script",
          "severity": "medium",
          "message": "内联脚本可能违反CSP策略",
          "line": 68,
          "recommendation": "将脚本移至外部文件或使用CSP nonce",
          "timestamp": 1760968390380
        },
        {
          "id": "bd66cad2-2ac7-4e73-be0b-f09e6b0afd75",
          "file": "examples\\vue-app\\index.html",
          "type": "inline-style",
          "severity": "low",
          "message": "内联样式可能违反CSP策略",
          "line": 1,
          "recommendation": "将样式移至外部CSS文件",
          "timestamp": 1760968390380
        },
        {
          "id": "c81090ad-6763-4b6c-968c-3945d745a3dc",
          "file": "docker-compose.yml",
          "type": "sensitive-data-exposure",
          "severity": "critical",
          "message": "配置文件中发现password",
          "line": 44,
          "recommendation": "将敏感信息移至环境变量或安全存储",
          "timestamp": 1760968390396
        },
        {
          "id": "b8359d67-fcd2-46b9-b7ae-3eedd33d6d05",
          "file": "docker-compose.yml",
          "type": "sensitive-data-exposure",
          "severity": "critical",
          "message": "配置文件中发现secret",
          "line": 17,
          "recommendation": "将敏感信息移至环境变量或安全存储",
          "timestamp": 1760968390396
        }
      ],
      "summary": {
        "critical": 3,
        "high": 1,
        "medium": 2,
        "low": 10,
        "info": 0
      }
    },
    "dependency": {
      "timestamp": 1760968390400,
      "dependencies": {
        "production": [
          "@aws-sdk/client-s3",
          "@azure/storage-blob",
          "ali-oss",
          "archiver",
          "axios",
          "bcryptjs",
          "cors",
          "crypto-js",
          "dotenv",
          "elliptic",
          "express",
          "helmet",
          "joi",
          "jose",
          "pqc-dilithium",
          "pqc-kyber",
          "rate-limiter-flexible",
          "secp256k1",
          "sqlite",
          "sqlite3",
          "winston",
          "yauzl"
        ],
        "development": [
          "@types/node",
          "@vitejs/plugin-react",
          "@vitejs/plugin-vue",
          "eslint",
          "jest",
          "nodemon",
          "react",
          "react-dom",
          "typescript",
          "vite",
          "vue"
        ],
        "total": 33
      },
      "vulnerabilities": [],
      "summary": {
        "critical": 0,
        "high": 0,
        "medium": 0,
        "low": 0,
        "info": 0
      },
      "recommendations": [
        {
          "type": "update-dependency",
          "package": "react",
          "message": "建议更新 react: 版本过旧，缺少安全更新",
          "priority": "medium"
        }
      ]
    },
    "dast": {
      "timestamp": 1760968395624,
      "scannedUrls": [],
      "vulnerabilities": [
        {
          "id": "9036a0d6-8177-4e17-aacb-b45080e79d68",
          "type": "missing-security-header",
          "severity": "medium",
          "message": "缺少安全头: Strict-Transport-Security",
          "recommendation": "配置Strict-Transport-Security安全头",
          "timestamp": 1760968395624
        },
        {
          "id": "3fe18b36-bc4b-46fc-b6ce-ec89214ebeec",
          "type": "missing-security-header",
          "severity": "medium",
          "message": "缺少安全头: Content-Security-Policy",
          "recommendation": "配置Content-Security-Policy安全头",
          "timestamp": 1760968395624
        },
        {
          "id": "1a535a7f-5ca2-4134-ac0e-72fb3acb6361",
          "type": "clickjacking",
          "severity": "medium",
          "message": "可能存在点击劫持风险",
          "recommendation": "配置X-Frame-Options或CSP frame-ancestors",
          "timestamp": 1760968395625
        }
      ],
      "summary": {
        "critical": 0,
        "high": 0,
        "medium": 3,
        "low": 0,
        "info": 0
      }
    }
  },
  "recommendations": [
    {
      "priority": "critical",
      "message": "发现3个严重漏洞，需要立即修复",
      "action": "优先修复所有严重级别的安全漏洞"
    },
    {
      "priority": "medium",
      "message": "代码中存在安全问题",
      "action": "审查代码，实施安全编码最佳实践"
    },
    {
      "priority": "medium",
      "message": "整体安全评分较低",
      "action": "实施全面的安全加固措施"
    }
  ],
  "securityScore": 0,
  "generatedAt": "2025-10-20T13:53:15.629Z",
  "scanDuration": 5305,
  "riskLevel": "Critical",
  "nextScanRecommended": "2025-10-27T13:53:15.631Z",
  "detailedVulnerabilities": {
    "codeQuality": [
      {
        "id": "dcd7fe60-74ad-40c0-aea2-92f94454b1eb",
        "file": "client\\secure\\crypto-loader.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 504,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390350
      },
      {
        "id": "69d78aac-bc52-4777-a51a-9d0dab25b6f9",
        "file": "examples\\ecc-demo.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 87,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390352
      },
      {
        "id": "b3d46521-081e-4398-96be-a73f5e575643",
        "file": "examples\\simple-worker-demo.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 29,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390353
      },
      {
        "id": "08653362-4719-4eb4-93f1-874eec345419",
        "file": "examples\\worker-demo.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 44,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390355
      },
      {
        "id": "f2abb4aa-09cf-44a6-8ec4-f7818ae8c832",
        "file": "monitoring-system.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 293,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390356
      },
      {
        "id": "345ad63a-3749-4547-9048-350845601dbf",
        "file": "run-advanced-monitoring.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 134,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390356
      },
      {
        "id": "562652dc-0f05-47a3-8718-0cb39fc05b14",
        "file": "run-feature-demo.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 58,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390359
      },
      {
        "id": "181d23a3-8f94-4228-98db-9abfe5b33f0d",
        "file": "run-monitoring.js",
        "type": "weak-randomness",
        "severity": "low",
        "message": "Math.random()不适用于安全相关的随机数生成",
        "line": 36,
        "recommendation": "使用crypto.randomBytes()或crypto.getRandomValues()生成安全随机数",
        "timestamp": 1760968390359
      },
      {
        "id": "1f31fb92-5ce3-428a-abc6-d7e487ae79cb",
        "file": "client\\secure\\index.html",
        "type": "inline-script",
        "severity": "medium",
        "message": "内联脚本可能违反CSP策略",
        "line": 292,
        "recommendation": "将脚本移至外部文件或使用CSP nonce",
        "timestamp": 1760968390380
      },
      {
        "id": "5a440e38-a0fb-4d82-88f7-d5a7b59240ba",
        "file": "client\\secure\\index.html",
        "type": "inline-style",
        "severity": "low",
        "message": "内联样式可能违反CSP策略",
        "line": 1,
        "recommendation": "将样式移至外部CSS文件",
        "timestamp": 1760968390380
      },
      {
        "id": "18bf701d-1230-4d4d-83aa-b40259ccfb49",
        "file": "examples\\vue-app\\index.html",
        "type": "inline-script",
        "severity": "medium",
        "message": "内联脚本可能违反CSP策略",
        "line": 68,
        "recommendation": "将脚本移至外部文件或使用CSP nonce",
        "timestamp": 1760968390380
      },
      {
        "id": "bd66cad2-2ac7-4e73-be0b-f09e6b0afd75",
        "file": "examples\\vue-app\\index.html",
        "type": "inline-style",
        "severity": "low",
        "message": "内联样式可能违反CSP策略",
        "line": 1,
        "recommendation": "将样式移至外部CSS文件",
        "timestamp": 1760968390380
      }
    ],
    "security": [
      {
        "id": "3ad3ffb4-4fd8-41cb-b951-2865f0f13c41",
        "file": "code-quality-analyzer.js",
        "type": "code-injection",
        "severity": "high",
        "message": "使用eval()可能导致代码注入攻击",
        "line": 234,
        "recommendation": "避免使用eval()，考虑使用JSON.parse()或其他安全替代方案",
        "timestamp": 1760968390351
      },
      {
        "id": "9036a0d6-8177-4e17-aacb-b45080e79d68",
        "type": "missing-security-header",
        "severity": "medium",
        "message": "缺少安全头: Strict-Transport-Security",
        "recommendation": "配置Strict-Transport-Security安全头",
        "timestamp": 1760968395624
      },
      {
        "id": "3fe18b36-bc4b-46fc-b6ce-ec89214ebeec",
        "type": "missing-security-header",
        "severity": "medium",
        "message": "缺少安全头: Content-Security-Policy",
        "recommendation": "配置Content-Security-Policy安全头",
        "timestamp": 1760968395624
      },
      {
        "id": "1a535a7f-5ca2-4134-ac0e-72fb3acb6361",
        "type": "clickjacking",
        "severity": "medium",
        "message": "可能存在点击劫持风险",
        "recommendation": "配置X-Frame-Options或CSP frame-ancestors",
        "timestamp": 1760968395625
      }
    ],
    "dependencies": [],
    "configuration": [
      {
        "id": "d61b82e5-dbce-4861-b9be-a0ef27c7f90e",
        "file": "run-feature-demo.js",
        "type": "hardcoded-secrets",
        "severity": "critical",
        "message": "检测到硬编码的敏感信息",
        "line": 25,
        "recommendation": "将敏感信息移至环境变量或安全配置文件",
        "timestamp": 1760968390359
      },
      {
        "id": "c81090ad-6763-4b6c-968c-3945d745a3dc",
        "file": "docker-compose.yml",
        "type": "sensitive-data-exposure",
        "severity": "critical",
        "message": "配置文件中发现password",
        "line": 44,
        "recommendation": "将敏感信息移至环境变量或安全存储",
        "timestamp": 1760968390396
      },
      {
        "id": "b8359d67-fcd2-46b9-b7ae-3eedd33d6d05",
        "file": "docker-compose.yml",
        "type": "sensitive-data-exposure",
        "severity": "critical",
        "message": "配置文件中发现secret",
        "line": 17,
        "recommendation": "将敏感信息移至环境变量或安全存储",
        "timestamp": 1760968390396
      }
    ],
    "compliance": []
  },
  "scanConfiguration": {
    "sastEnabled": true,
    "dependencyEnabled": true,
    "dastEnabled": true
  },
  "complianceStatus": {
    "owasp": {
      "score": 80,
      "issues": [
        "存在严重安全漏洞"
      ],
      "recommendations": []
    },
    "gdpr": {
      "score": 50,
      "issues": [
        "存在硬编码敏感信息",
        "存在敏感数据泄露风险"
      ],
      "recommendations": []
    },
    "pci": {
      "score": 0,
      "issues": [],
      "recommendations": []
    }
  },
  "trendAnalysis": {
    "securityTrend": "needs_attention",
    "vulnerabilityTrend": "increasing",
    "riskTrend": "critical",
    "recommendations": [
      "建议每周进行一次漏洞扫描",
      "优先修复严重和高危漏洞",
      "建立漏洞管理流程",
      "定期更新依赖项"
    ]
  }
}